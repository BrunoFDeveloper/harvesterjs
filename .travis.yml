language: node_js
node_js:
  - '0.10'
before_script:
  - mkdir testdb
  - mongod --port 27017 --dbpath testdb --replSet rs0 --oplogSize 20 --noprealloc --fork --smallfiles --logpath mongodb.log
  - sleep 3
  - mongo admin --eval 'printjson(rs.initiate());'
  - sleep 20
deploy:
  provider: npm
  email: developer@agcocorp.com
  api_key:
    secure: ehXWO5DfnyHQcdHkNlECfAEFSY1p4yTuWAkOkFRk53oD2l7XMhq9hwK+VbF2uaVR0xzFml2gDNz0Zd7KiR4qaJAptEYPKzXMW/BT4vP+DnODmf3+khKdQcbNlUcoRPOOVVIKDnAZQijWP1+funpAQiYe/BwoL3cF0r8vHuBnQc4=
  on:
    tags: true
    repo: agco/harvesterjs
    branch: master

